import "spherical_voronoi" as sv; sv::remove_vertexes_on_border([[0, 0], [10, 10]])
[ [5, 5], [1, 3], [17, 8], [6, 9] ]
[ [5, 5], [6, 9], [1, 3] ]

import "spherical_voronoi" as sv; sv::merge_cell
[ [[1.5, 0.5], [1.4, 0.6], [1.9, 0.7], [2, 0.8], [2.1, 0.7]], [[1.5, 0.5], [0.1, 0], [2.9, 0.1]] ]
[ [1.5, 0.5], [1.4, 0.6], [1.9, 0.7], [2, 0.8], [2.1, 0.7], [0.1, 0], [2.9, 0.1] ]

import "spherical_voronoi" as sv; sv::project_vertex([1.5, 0])
[ 1.7, 0 ]
[ 0, 1.0724805325845908 ]

import "spherical_voronoi" as sv; sv::project_cell
[ [0.4, 0.9], [0.6, 0.7], [0.4, 0.8], [0.2, 1] ]
[ [1.1525719972156676, 1.5860253418435635], [0.8621700546672263, 1.6948904028030696], [1.1071487177940904, 1.6876550346216943], [1.373400766945016, 1.5756991908878328] ]

import "spherical_voronoi" as sv; sv::project_cell_to_plane | sv::project_cell
[ [-1.6,1.8], [-0.9,2.2], [-1.8,1.2], [-2,2] ]
[ [-1.6,1.8], [-0.9,2.2000000000000006], [-1.8,1.2000000000000002], [-2,2]]

import "sphere" as sphere; import "spherical_voronoi" as sv; map(sphere::spherical_flip) | sv::project_cell_to_plane | sv::project_cell | map(sphere::spherical_flip)
[[0,0], [-1.9711627817482313,0.20100613910825738], [1.683237846710878,0.8477314217794145], [-1.055715797863998,0.323121724552887]]
[[0,0], [-1.9711627817482313,0.20100613910825738], [1.683237846710878,0.8477314217794145], [-1.055715797863998,0.323121724552887]]

import "spherical_voronoi" as sv; sv::clip([[0.004258720967797164,-0.3220920634533136],[-0.10998041530157354,-0.19986849251759548],[-0.15411739493784132,0.03642274543882432],[0.1459351596269618,-0.0033398927046510373],[0.18512501081286606,-0.2687570706224387],[0.03461862575663566,-0.3198574864009238]])
[[-0.1876424616707376,0.08820610760454158],[-0.09257054542803854,0.05293267648969922],[-0.1876424616707376,0.02718050418554346],[-0.1876424616707376,0.08820610760454158],[-0.07934809523128236,0.08820610760454158]]
[[-0.1876424616707376,0.08820610760454158], [-0.15408871813760402,0.03626922164348219], [-0.1537175542134442,0.03636975898096101]]

import "spherical_voronoi" as sv; . as $s | [1.2187718354308166, 1.0606137785390146] | sv::rotation_matrices | .[0] as $R | $s | map(sv::rotate_site($R))
[ [3, 1.5], [1, 1], [0.3, 1.5] ]
[ [2.9556110556378448, 1.7186160873550638], [5.563364070980961, 0.1969856955368046], [6.217970979830411, 0.9730976554454301] ]

import "spherical_voronoi" as sv; . as $s | [1.2, 1] | sv::rotation_matrices | . as [$R, $IR] | $s | map(sv::rotate_site($R)) | map(sv::rotate_site($IR))
[ [3, 1.5], [1, 1], [0.3, 1.5] ]
[ [3, 1.5000000000000002], [1, 1], [0.29999999999999993, 1.5] ]

import "spherical_voronoi" as sv; sv::is_whole
[[[0.9999999999999997,0.9999999999999999],[4.791592653589792,0.8050937554213236],[0.9269024715767251,1.6375758950233006],[1.6499999999999992,2.3364988981684705],[3.1079917240425963,0.31888058295503424]],[[0.29999999999999977,1.4999999999999996],[4.791592653589793,0.8050937554213219],[1.6499999999999995,2.5128867987530343],[1.6499999999999992,2.3364988981684705],[0.9269024715767239,1.637575895023299]],[[3,1.5000000000000002],[4.791592653589793,0.8050937554213219],[3.1079917240425954,0.31888058295503396],[1.6499999999999992,2.3364988981684705],[1.6499999999999995,2.512886798753035]]]
true

import "spherical_voronoi" as sv; sv::is_whole
[[[0.9999999999999997,0.9999999999999999],[4.791592653589792,0.8050937554213236],[0.9269024715767251,1.6375758950233006],[1.6499999999999992,2.3364988981684705],[3.1079917240425963,0.31888058295503424]],[[0.29999999999999977,1.4999999999999996],[4.791592653589793,0.8050937554213219],[1.6499999999999995,2.5128867987530343],[1.6499999999999992,2.3364988981684705],[0.9269024715767239,1.637575895023299]]]
false

# Test degenerate cases

# No sites
import "spherical_voronoi" as sv; sv::spherical_voronoi
[]
[]

# Single site
import "spherical_voronoi" as sv; sv::spherical_voronoi
[ [3, 1.5] ]
[[[3,1.5],[6.1417341181078,1.6406026603903985],[6.142585142196042,1.6417337388231636],[6.141451169207306,1.6425826453769283],[6.1406001848480045,1.6414514988538427]]]

import "spherical_voronoi" as sv; sv::spherical_voronoi
[ [0, 0] ]
[[[0,0],[0,3.1405926535897932],[1.5707963267948966,3.1405926535897932],[3.141592653589793,3.1405926535897932],[4.71238898038469,3.1405926535897932]]]

# Two points
import "spherical_voronoi" as sv; sv::spherical_voronoi
[ [0, 0], [0, 3.141592653589793] ]
[[[5.8970315200670305,3.141592653589793],[4.71238898038469,1.5707963267948968],[0,1.5707963267948966],[1.5707963267948966,1.5707963267948966],[3.141592653589793,1.5707963267948968]],[[3.3621779404920735,2.275584473109651e-16],[4.71238898038469,1.5707963267948968],[3.141592653589793,1.5707963267948968],[1.5707963267948966,1.5707963267948966],[0,1.5707963267948966]]]

import "spherical_voronoi" as sv; sv::spherical_voronoi
[ [0.7, 1.5], [1.3, 2.2] ]
[[[1.3,2.2],[5.463260989293651,2.1928792293134767],[0.9676389914634045,1.8621967485504396],[2.3216683357038574,0.9487134242763166],[4.109231645053198,1.2793959050393537]],[[0.6999999999999998,1.5],[5.463260989293651,2.1928792293134767],[4.109231645053198,1.2793959050393537],[2.3216683357038574,0.9487134242763166],[0.9676389914634045,1.8621967485504396]]]

# Collinear points
import "spherical_voronoi" as sv; sv::spherical_voronoi
[ [1, 1.5], [1, 1], [1, 2.2] ]
[[[1,1.5],[2.5707963267948966,1.570796326794897],[0.9999999999999997,1.85],[5.71238898038469,1.5707963267948963],[0.9999999999999999,1.25]],[[0.9999999999999998,0.9999999999999999],[2.5707963267948966,1.570796326794897],[0.9999999999999999,1.25],[5.71238898038469,1.5707963267948963],[4.141592653589793,1.5415926535897932]],[[1,2.2],[2.5707963267948966,1.570796326794897],[4.141592653589793,1.5415926535897932],[5.71238898038469,1.5707963267948963],[0.9999999999999997,1.85]]]

# Test normal cases
import "spherical_voronoi" as sv; sv::spherical_voronoi
[ [3, 1.5], [1, 1], [0.3, 1.5] ]
[[[0.9999999999999997,0.9999999999999999],[4.791592653589792,0.8050937554213236],[0.9269024715767251,1.6375758950233006],[1.6499999999999992,2.3364988981684705],[3.1079917240425963,0.31888058295503424]],[[0.29999999999999977,1.4999999999999996],[4.791592653589793,0.8050937554213219],[1.6499999999999995,2.5128867987530343],[1.6499999999999992,2.3364988981684705],[0.9269024715767239,1.637575895023299]],[[3,1.5000000000000002],[4.791592653589793,0.8050937554213219],[3.1079917240425954,0.31888058295503396],[1.6499999999999992,2.3364988981684705],[1.6499999999999995,2.512886798753035]]]
